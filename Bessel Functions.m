x = linspace(0,20,500);  % ????? ????? x
nmax = 5;  % ?????? ????? ????? ???
colors = hsv(nmax+1);  % ????? ??? ??
figure;  % ??? ????? ???
for n = 0:nmax
    J = besselj(n,x);  % ?????? ???? ??? ?? ????? n
    plot(x,J,'color',colors(n+1,:),'LineWidth',2);  % ??? ???? ??? ?? ??? ??????
    hold on;  % ??? ????? ?????? ???? ?????? ???? ?????
end
xlabel('x');  % ???????? ???? x
ylabel('J_n(x)');  % ???????? ???? y
legend('n=0','n=1','n=2','n=3','n=4','n=5');  % ????? ?????? ???? ????????? ?????
%----------------------------------------------------------------------------------
%%
x = linspace(0,20,500);  % ????? ????? x
nmax = 5;  % ?????? ????? ????? ???
colors = hsv(nmax+1);  % ????? ??? ??
figure;  % ??? ????? ??? ??? ?
for n = 0:nmax
    J = besselj(n,x);  % ?????? ???? ??? ?? ????? n
    Y = bessely(n,x);  % ?????? ???? ??? ??? ? ?? ????? n
    plot(x,J,'color',colors(n+1,:),'LineWidth',2);  % ??? ???? ??? ?? ??? ??????
    hold on;
    plot(x,Y,'--','color',colors(n+1,:),'LineWidth',2);  % ??? ???? ??? ??? ? ?? ??? ??????
end
xlabel('x');  % ???????? ???? x
ylabel('J_n(x), Y_n(x)');  % ???????? ???? y
legend('n=0','n=1','n=2','n=3','n=4','n=5');
figure;  % ??? ????? ??? ??? ?????
for n = 1:nmax
    N = besselj(n-1,x) - n./x.*besselj(n,x);  % ?????? ???? ??? ????? ?? ????? n
    plot(x,N,'color',colors(n,:),'LineWidth',2);  % ??? ???? ??? ????? ?? ??? ??????
    hold on;
end
xlabel('x');  % ???????? ???? x
ylabel('N_n(x)');  % ???????? ???? y
legend('n=1','n=2','n=3','n=4','n=5');
%%
clc
clear
close all

% Parameters
n = 10; % Maximum order
m = 100; % Number of data points
x = linspace(-10,10,m); % Range of x values

% Bessel function of the first kind and its derivatives
J = zeros(n+1,m);
Jp = zeros(n+1,m);
Jpp = zeros(n+1,m);
for k = 0:n
    J(k+1,:) = besselj(k,x);
    Jp(k+1,:) = besselj(k+1,x);
    Jpp(k+1,:) = besselj(k+2,x);
end

% Neumann function and its derivatives
Y = zeros(n+1,m);
Yp = zeros(n+1,m);
Ypp = zeros(n+1,m);
for k = 0:n
    Y(k+1,:) = bessely(k,x);
    Yp(k+1,:) = bessely(k+1,x);
    Ypp(k+1,:) = bessely(k+2,x);
end

% Hankel function of the first kind and its derivatives
H1 = zeros(n+1,m);
H1p = zeros(n+1,m);
H1pp = zeros(n+1,m);
for k = 0:n
    H1(k+1,:) = besselh(k,1,x);
    H1p(k+1,:) = besselh(k+1,1,x);
    H1pp(k+1,:) = besselh(k+2,1,x);
end

% Hankel function of the second kind and its derivatives
H2 = zeros(n+1,m);
H2p = zeros(n+1,m);
H2pp = zeros(n+1,m);
for k = 0:n
    H2(k+1,:) = besselh(k,2,x);
    H2p(k+1,:) = besselh(k+1,2,x);
    H2pp(k+1,:) = besselh(k+2,2,x);
end

% Plot Bessel functions of the first kind and its derivatives
figure
subplot(3,1,1)
hold on
for k = 0:n
    plot(x,J(k+1,:),'LineWidth',1.2)
end
title('Bessel Function of the First Kind and Its Derivatives')
legend('J_0(x)','J_1(x)','J_2(x)','J_3(x)','J_4(x)','J_5(x)','J_6(x)','J_7(x)','J_8(x)','J_9(x)','Location','NorthEastOutside')
ylabel('J_n(x)')
grid on

subplot(3,1,2)
hold on
for k = 0:n
    plot(x,Jp(k+1,:),'LineWidth',1.2)
end
ylabel('J''_n(x)')
grid on

subplot(3,1,3)
hold on
for k = 0:n
    plot(x,Jpp(k+1,:),'LineWidth',1.2)
end
ylabel('J''''_n(x)')
xlabel('x')
grid on
%%
% ????? ????? ??
n = 5; % ????? ???? ????
x = linspace(0, 50, 1000); % ???? ?? (???? ??? ?? ?????? ???? ??????? ???)

% ????? ???? ???? ??? ? ? ?
H1 = zeros(n, length(x)); % ???? ???? ??? ?
H2 = zeros(n, length(x)); % ???? ???? ??? ?

for i = 1:n
    H1(i,:) = besselh(i-1, 1, x); % ???? ???? ??? ? ?? ????? i-1
    H2(i,:) = besselh(i-1, 2, x); % ???? ???? ??? ? ?? ????? i-1
end

% ????? ????? ????
figure;

% Real part of Hankel Function H1
subplot(2,2,1);
plot(x, real(H1(1,:)), x, real(H1(2,:)), x, real(H1(3,:)), x, real(H1(4,:)), x, real(H1(5,:)));
legend('n=1', 'n=2', 'n=3', 'n=4', 'n=5');
xlabel('x');
ylabel('Re(H_1^{(n)}(x))');
title('Real Part of Hankel Function H1');
grid on;

% Imaginary part of Hankel Function H1
subplot(2,2,2);
plot(x, imag(H1(1,:)), x, imag(H1(2,:)), x, imag(H1(3,:)), x, imag(H1(4,:)), x, imag(H1(5,:)));
legend('n=1', 'n=2', 'n=3', 'n=4', 'n=5');
xlabel('x');
ylabel('Im(H_1^{(n)}(x))');
title('Imaginary Part of Hankel Function H1');
grid on;

% Real part of Hankel Function H2
subplot(2,2,3);
plot(x, real(H2(1,:)), x, real(H2(2,:)), x, real(H2(3,:)), x, real(H2(4,:)), x, real(H2(5,:)));
legend('n=1', 'n=2', 'n=3', 'n=4', 'n=5');
xlabel('x');
ylabel('Re(H_2^{(n)}(x))');
title('Real Part of Hankel Function H2');
grid on;

% Imaginary part of Hankel Function H2
subplot(2,2,4);
plot(x, imag(H2(1,:)), x, imag(H2(2,:)), x, imag(H2(3,:)), x, imag(H2(4,:)), x, imag(H2(5,:)));
legend('n=1', 'n=2', 'n=3', 'n=4', 'n=5');
xlabel('x');
ylabel('Im(H_2^{(n)}(x))');
title('Imaginary Part of Hankel Function H2');
grid on;